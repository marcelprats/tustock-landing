---
import Layout from '~/layouts/PageLayout.astro';
// ... tus otros imports

const returnTo = Astro.url.searchParams.get('return_to');
const title = returnTo ? `Entrar a ${returnTo}` : "Bienvenido";
---

<Layout metadata={{ title: "Login" }}>
  
  <section class="flex flex-col items-center justify-center min-h-screen p-4">
    
    <h1 class="text-3xl font-bold mb-6 text-center">{title}</h1>

    <form id="login-form" class="max-w-sm w-full space-y-4">
       <button type="submit" class="w-full btn-primary">Entrar</button>
    </form>

  </section>

</Layout>

<script>
  // TU SCRIPT DE LOGIN
  const form = document.getElementById('login-form');
  
  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      // ... recoger datos ...
      
      try {
        const res = await fetch('/api/login', {
           method: 'POST',
           body: JSON.stringify({ email, password }), // etc
        });
        
        const data = await res.json();
        
        if (data.success) {
          // LA API NOS DICE A DÃ“NDE IR (AL SUBDOMINIO)
          window.location.href = data.redirectUrl;
        } else {
          alert(data.error);
        }
      } catch (error) {
        console.error(error);
      }
    });
  }
</script>