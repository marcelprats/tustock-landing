---
import Layout from '~/layouts/Layout.astro';
import StoreDashboard from '~/components/store/admin/StoreDashboard.astro'; 

const { currentShop } = Astro.locals;
const session = Astro.cookies.get('session');

// Validación de sesión
if (!session) return Astro.redirect('/login');

const metadata = { title: `Admin - ${currentShop?.name}` };
---

<Layout tenant={currentShop.slug} metadata={metadata}>
  
  {/* Sección Principal con padding y fondo ajustado al tema */}
  <section class="page-content py-8 md:py-12 bg-page min-h-screen">
      <div class="max-w-6xl mx-auto px-4 sm:px-6">
          
          {/* Cabecera del Dashboard */}
          <div class="flex flex-col md:flex-row md:items-center justify-between mb-8 pb-6 border-b border-gray-200 dark:border-gray-700">
              <div>
                <h1 class="text-3xl font-bold font-heading text-heading leading-tight">
                    {currentShop.name}
                </h1>
                <p class="text-muted text-sm mt-1">
                    Panel de control en tiempo real.
                </p>
              </div>
              
              <div class="mt-4 md:mt-0 flex gap-3">
                  <a href="/" target="_blank" class="btn-secondary px-4 py-2 text-sm">
                      Ver Tienda
                  </a>
                  <a href="/api/logout" class="btn-secondary px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:text-red-700 border-red-200 dark:border-red-900/30">
                      Salir
                  </a>
              </div>
          </div>

          {/* Carga del Dashboard */}
          <StoreDashboard tenantId={currentShop.slug} />
      </div>
  </section>

</Layout>