---
import StoreAdminLayout from '~/layouts/StoreAdminLayout.astro';
// Si quieres usar widgets del dashboard, impórtalos sueltos o asegúrate que AppDashboard NO tenga Layout
import AppDashboard from '~/components/app/AppDashboard.astro'; 

const { currentShop } = Astro.locals;
const session = Astro.cookies.get('session');

// Seguridad básica
if (!session) return Astro.redirect('/login');

const metadata = { title: `Admin - ${currentShop?.name}` };
---

<StoreAdminLayout tenant={currentShop.slug} metadata={metadata}>
  
  {/* Cabecera interna del Dashboard */}
  <div class="mb-8">
      <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Resumen de Actividad</h2>
      <p class="text-gray-500">Bienvenido de nuevo a tu panel.</p>
  </div>

  {/* Aquí carga el Dashboard. IMPORTANTE: Que AppDashboard NO tenga <Layout> dentro */}
  <AppDashboard tenantId={currentShop.slug} />

</StoreAdminLayout>