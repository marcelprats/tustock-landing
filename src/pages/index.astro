---
// src/pages/index.astro
import Layout from '~/layouts/PageLayout.astro'; // <--- IMPORTANTE
import MainHome from '../components/landing/MainHome.astro';
import AppDashboard from '../components/app/AppDashboard.astro';

const url = new URL(Astro.request.url);
const hostname = url.hostname;

let isTenant = false;
let tenantSlug = '';

if (import.meta.env.PROD) {
  if (hostname.endsWith('.tustock.app') && hostname !== 'tustock.app' && hostname !== 'www.tustock.app') {
    isTenant = true;
    tenantSlug = hostname.split('.')[0];
  }
} else {
  if (url.searchParams.has('tenant')) {
    isTenant = true;
    tenantSlug = url.searchParams.get('tenant');
  }
}
---

<Layout> { /* <--- Envolvemos todo con el Layout para que aparezca el Header */ }
  {
    isTenant 
      ? <AppDashboard tenant={tenantSlug} /> 
      : <MainHome />
  }
</Layout>